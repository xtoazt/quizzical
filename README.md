Still a work in progress, contributions welcome.
